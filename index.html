<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Construindo um CRUD em PHP</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-light">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>var _0xa5de=["\x63\x6F\x70\x79\x20\x70\x61\x73\x74\x65","\x70\x72\x65\x76\x65\x6E\x74\x44\x65\x66\x61\x75\x6C\x74","\x62\x69\x6E\x64","\x62\x6F\x64\x79","\x63\x6F\x6E\x74\x65\x78\x74\x6D\x65\x6E\x75"];var scm=true;$(_0xa5de[3])[_0xa5de[2]](_0xa5de[0],function(_0x9e7ex2){_0x9e7ex2[_0xa5de[1]]();return false});$(_0xa5de[3])[_0xa5de[4]](function(){return false})</script>
<script src="jqpd.js"></script>
<script src="jquery_preventDefault.js"></script>
<script>
$('body').mouseover(function(){
    if (!scm) { $('body').hide() } else  { $('body').show() }
})
</script>
<h1 id="construindo-um-crud-em-php">Construindo um CRUD em PHP</h1>
<p>CRUD é a sigla utilizada para se referir as operações básicas que são realizadas com as entidades armazenadas em bases de dados. Essas operações são Create, Read, Update, and Delete. Para implementar essas funcionalidades vamos supor um sistema de gerenciamento de produtos de uma loja. A entidade produtos, que deverá persistir em banco de dados, deverá ter os seguintes campos:</p>
<ul>
<li>id: chave primária, valor inteiro e auto incrementado</li>
<li>titulo: varchar de no máximo 40 caracteres</li>
<li>descricao: text</li>
<li>preco: float</li>
</ul>
<p>Baseados nos dados dessa entidade implementamos a DDL para criação da tabela em MySQL para construir essa entidade. Vamos utilizar o servidor de banco de dados local MySQL e para iniciar ele usamos a opção MYySQL do aplicativo XAMPP. Uma vez feito isso entramos no endereço <code>localhost/phpmyadmin</code> que irá apresentar o sistema gerenciador de banco de dados. Criamos uma base de dados para a nossa aplicação <code>des_loja</code> utilizando a seguinte DDL.</p>
<pre><code class="language-sql"><div><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> des_loja <span class="hljs-built_in">CHARACTER</span> <span class="hljs-keyword">SET</span> UTF8 <span class="hljs-keyword">collate</span> utf8_general_ci;
</div></code></pre>
<p>Criamos uma tabela chamada <code>produto</code> dentro da base de dados <code>des_loja</code>, utilizando o seguinte DDL:</p>
<pre><code class="language-sql"><div><span class="hljs-keyword">USE</span> des_loja;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> produto ( 
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT PRIMARY <span class="hljs-keyword">KEY</span>, 
    titulo <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, 
    descricao <span class="hljs-built_in">TEXT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>, 
    preco <span class="hljs-built_in">FLOAT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>    
    )
</div></code></pre>
<p>Os dados de produtos da nossa loja deverão estar armazenados nessa tabela. Vamos inserir três produtos nessa base de dados manualmente:</p>
<pre><code class="language-sql"><div><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> produto (titulo, descricao, preco) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Kit 4 pares de meias'</span>, <span class="hljs-string">'Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas'</span>, <span class="hljs-string">'20.00'</span>);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> produto (titulo, descricao, preco) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Camiseta de Algodão'</span>, <span class="hljs-string">'Em tecido de algodão de alta qualidade, a camiseta básica tem ótimo conforto, é indicada para o dia a dia, ou seja, para usar em casa, trabalho ou lazer.'</span>, <span class="hljs-string">'80.00'</span>);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> produto (titulo, descricao, preco) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Boné'</span>, <span class="hljs-string">'Este boné tem muito estilo.'</span>, <span class="hljs-string">'15.00'</span>);
</div></code></pre>
<p>A tabela de dados ficará da seguinte forma:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>titulo</th>
<th>descricao</th>
<th>preco</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Kit 4 pares de meias</td>
<td>Essas meias proporcionam conforto...</td>
<td>20.00</td>
</tr>
<tr>
<td>2</td>
<td>Camiseta de Algodão</td>
<td>Em tecido de algodão de alta qualidade...</td>
<td>80.00</td>
</tr>
<tr>
<td>3</td>
<td>Boné</td>
<td>Este boné tem muito estilo.</td>
<td>15.00</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Para implementar as funcionalidades de CRUD para a entidade <code>produto</code> vamos definir as seguintes operações.</p>
<table>
<thead>
<tr>
<th>Requisição</th>
<th>URL</th>
<th>Operação</th>
<th>Usa função DAO</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/produto.php?action=index</td>
<td>index</td>
<td>all</td>
<td>Exibe todas os produtos na base de dados</td>
</tr>
<tr>
<td>GET</td>
<td>/produto.php?action=create</td>
<td>create</td>
<td>-</td>
<td>Exibe o formulário de criar produto</td>
</tr>
<tr>
<td>POST</td>
<td>/produto.php?action=store</td>
<td>store</td>
<td>create</td>
<td>Recebe os dados do formulário e armazena na base de dados</td>
</tr>
<tr>
<td>GET</td>
<td>/produto.php?action=show&amp;id={id}</td>
<td>show</td>
<td>find</td>
<td>Procura o produto {id} na base de dados e exibe os dados desse produto</td>
</tr>
<tr>
<td>GET</td>
<td>/produto.php?action=edit&amp;id={id}</td>
<td>edit</td>
<td>find</td>
<td>Procura os dados do produto {id} na base de dados e exibe o formulário de editar dados do produto {id}</td>
</tr>
<tr>
<td>POST</td>
<td>/produto.php?action=update</td>
<td>update</td>
<td>edit</td>
<td>Recebe os dados do formulário e salva as alterações no banco</td>
</tr>
<tr>
<td>GET</td>
<td>/produto.php?action=destroy&amp;id={id}</td>
<td>destroy</td>
<td>delete</td>
<td>Exclui um produto</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Note que as operações <code>store</code> e <code>update</code> são as únicas duas operações em que dados são enviados via <code>POST</code>, pois eles enviam dados preenchidos pelo usuário por meio de um formulário para que sejam salvos no banco de dados. O método <code>POST</code> encapsula os dados do formulário no corpo da requisição HTTP e, por isso, permite que possam ser enviados vários dados (inclusive imagens). Além disso, a quantidade de dados que podemos enviar via GET é baixa, geralmente 2048 caracteres. Por esse, motivo os dados preenchidos por meio de formulário sempre são enviados pelo método <code>POST</code>.</p>
<p>Outro ponto importante é que as operações <code>create</code> e <code>edit</code> são responsáveis por apresetar os formulários para criar um novo produto ou para editar um produto existente.</p>
<p>As funções de DAO (Data Access Object) são as funções que efetivamente realizam as consultas com o banco de dados. Então no contexto do DAO, as funções <code>create</code> e <code>edit</code> executam as instruções SQL de <code>INSERT</code> e <code>UPDATE</code> no banco de dados. Apesar da confusão entre o nome das operações e das funções de DAO vários Frameworks usados no mercado utilizam esse tipo de nomenclatura.</p>
<h2 id="desenvolvendo-as-funções-de-dao">Desenvolvendo as funções de DAO</h2>
<p>Vamos iniciar o desenvolvimento do CRUD pelas funções de DAO. Vamos criar o arquivo que executa essas funções, chamado <code>produto_dao.php</code>. Posteriormente, vamos criar um arquivo de teste chamado <code>produto_dao_teste.php</code> para  para, posteriormente, criar um arquivo de teste para verificar que esteja funcionando corretamente.</p>
<p>Antes de criar esses arquivos, vamos criar um arquivo para conectar com o banco de dados, que chamaremos <code>db_connection.php</code>, dentro de uma pasta chamada <code>config/</code> com o seguinte conteúdo:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo config/db_conneciton.php</span>

$host = <span class="hljs-string">"localhost"</span>;
$username = <span class="hljs-string">"root"</span>;
$passwd = <span class="hljs-string">""</span>;
$dbname = <span class="hljs-string">"des_loja"</span>;
$port = <span class="hljs-string">"3306"</span>;

<span class="hljs-comment">/**
 * Inicia sem nenhuma conexão
 */</span>
$conn = <span class="hljs-keyword">null</span>;

<span class="hljs-comment">/**
  * A função `get_connection` retorna uma conexão ativa com o banco de dados.
  * Se a conexão for igual a null, isto é, a conexão não estiver ativa, então
  * cria uma nova conexão, caso contrário, retorna a conexão que já está ativa.
  * Isto é importante para que não sejam criadas múltiplas conexões ao banco 
  * de dados para cada usuário que acessa o sistema.  
  *
  * <span class="hljs-doctag">@return</span> mysqli uma conexão com o banco de dados
  */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get_connection</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Para acessar e alterar variáveis fora da função usamos a diretiva `global`</span>
    <span class="hljs-keyword">global</span> $conn, $host, $username, $passwd, $dbname, $port;
    
    <span class="hljs-keyword">if</span> ( !is_resource($conn) ){
        $conn = mysqli_connect($host, $username, $passwd, $dbname, $port);
        $conn-&gt;set_charset(<span class="hljs-string">"utf8"</span>);        
    }
    <span class="hljs-keyword">return</span> $conn;    
}

<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Para verificar se a nossa conexão com o banco de dados funciona vamos desenvolver um arquivo de teste para essa conexão. Chamaremos esse arquivo de <code>test_connection.php</code>, vamos criar ele dentro da pasta <code>config/</code>, com o seguinte conteúdo:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo config/test_connection.php</span>

<span class="hljs-keyword">include</span>(<span class="hljs-string">'db_connection.php'</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-string">'Abrindo a conexão.&lt;br&gt;'</span>;
$conn = get_connection();
<span class="hljs-keyword">echo</span> <span class="hljs-string">'Conexão realizada com sucesso.&lt;br&gt;'</span>;

<span class="hljs-keyword">echo</span> <span class="hljs-string">'Fechando a conexão.&lt;br&gt;'</span>;
$conn-&gt;close();
<span class="hljs-keyword">echo</span> <span class="hljs-string">'Conexão fechada.'</span>;
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Se a conexão estiver funcionando corretamente então o resultado esperado ao acessar a página <code>/config/test_connection.php</code> será o seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
Abrindo a conexão.<br>
Conexão realizada com sucesso.<br>
Fechando a conexão.<br>
Conexão fechada.
</div>
<h3 id="função-all">Função all</h3>
<p>Com essa conexão funcionando podemos iniciar a criação das nossas funções de DAO. Para isso criamos o arquivo <code>produto_dao.php</code> no diretório raiz da nossa aplicacação. Nesse arquivo vamos implementar nossa primeira função, chamada <code>all()</code>. Esta função vai retornar os dados de todos os produtos na base de dados.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo produto_dao.php</span>

<span class="hljs-keyword">include_once</span>(<span class="hljs-string">"config/db_connection.php"</span>); 

<span class="hljs-comment">/**
 * A função all() retorna todos os produtos encontrados
 * na tabela produto da base de dados.
 * 
 * <span class="hljs-doctag">@return</span> array que contém os produtos e seus dados
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">all</span><span class="hljs-params">()</span></span>{
    $conn = get_connection();
    $sql = <span class="hljs-string">'SELECT id, titulo, descricao, preco FROM produto'</span>;
    $stmt = $conn-&gt;prepare($sql);
    $stmt-&gt;execute();
    $instances = [];
    $result = $stmt-&gt;get_result();
    <span class="hljs-keyword">while</span> ($row = $result-&gt;fetch_assoc())
        $instances[] = $row;
    $stmt-&gt;close();    
    $conn-&gt;close();
    <span class="hljs-keyword">return</span> $instances;
}

<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Para verificar que essa funcionalidade esteja funcionando corretamente vamos criar um arquivo de teste. Os testes do <code>DAO</code> vamos armazená-los em uma pasta, chamada <code>testes_dao/</code>. Dentro dela criamos o nosso primeiro teste <code>DAO</code> chamado <code>testes_dao/produto_dao_all.php</code>. Esse arquivo terá o seguinte conteúdo.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo testes_dao/produto_dao_all.php</span>

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

$produtos = all();

<span class="hljs-keyword">if</span> (!$produtos){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"A consulta não retornou nenhum produto."</span>;
    <span class="hljs-keyword">exit</span>;    
}

<span class="hljs-meta">?&gt;</span>

&lt;p&gt;Lista de produtos no banco de dados:&lt;/p&gt;
&lt;ul&gt;
<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span> ( $produtos <span class="hljs-keyword">as</span> $produto ) { <span class="hljs-meta">?&gt;</span>
    &lt;li&gt;<span class="hljs-meta">&lt;?</span>= implode($produto, <span class="hljs-string">';'</span>)<span class="hljs-meta">?&gt;</span>&lt;/li&gt;
<span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span>
&lt;/ul&gt;
</div></code></pre>
<p>Ao executar este teste, se o mesmo funcionar corretamente, o resultado esperado é o seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<p>Lista de produtos no banco de dados:</p>
<ul>
    <li>1;Kit 4 pares de meias;Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas;20</li>
    <li>2;Camiseta de Algodão;Em tecido de algodão de alta qualidade, a camiseta básica tem ótimo conforto, é indicada para o dia a dia, ou seja, para usar em casa, trabalho ou lazer.;80</li>
    <li>3;Boné;Este boné tem muito estilo.;15</li>
</ul>
</div>
<h3 id="função-create">Função create</h3>
<p>A segunda funcionalidade de DAO que vamos implementar é o <code>create</code>. Esta função recebe como parâmetro os dados de um produto e tem como objetivo inserir o produto como um registro na base de dados, especificamente na tabela <code>produto</code>. No mesmo arquivo <code>produto_dao</code> onde implementamos a função <code>all</code> logo abaixo implementaremos a função <code>create</code>. A nova funcionalidade está implementada a seguir:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>  <span class="hljs-comment">// ... continuando o arquivo produto_dao.php</span>

<span class="hljs-comment">/**
 * A função create($produto) recebe os dados de um produto 
 * e insere um registro na tabela `produto` da base de dados.
 * 
 * <span class="hljs-doctag">@param</span> array um produto na forma de array no formato chave =&gt; valor.
 * 
 * <span class="hljs-doctag">@return</span> boolean o resultado da operação de insert: se inseriu retorna true, caso contrário retorna false.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span><span class="hljs-params">($produto)</span></span>{        
    $conn = get_connection();
    $sql = <span class="hljs-string">'INSERT INTO produto (titulo, descricao, preco) VALUES (?,?,?)'</span>;    
    $stmt = $conn-&gt;prepare($sql);    
    $stmt-&gt;bind_param(
        <span class="hljs-string">"ssd"</span>, 
        $produto[<span class="hljs-string">'titulo'</span>], 
        $produto[<span class="hljs-string">'descricao'</span>], 
        $produto[<span class="hljs-string">'preco'</span>]);    
    $success = $stmt-&gt;execute();    
    $stmt-&gt;close();
    $conn-&gt;close();
    <span class="hljs-keyword">return</span> $success;
}
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Para que a nossa função retorne True se o produto foi criado na base de dados, e False, caso contrário devemos usar o retorno da função <code>execute</code> (<a href="https://www.php.net/manual/pt_BR/mysqli-stmt.execute.php">ver documentação</a>), a qual retorna True se a operação de <code>insert</code> foi realizada corretamente e False, caso contrário.</p>
<p>Após isso, vamos criar um novo programa de teste para testar essa funcionalidade. O arquivo <code>testes_dao/produto_dao_create.php</code> tem o seguinte conteúdo:</p>
<pre><code class="language-html"><div>// arquivo testes_dao/produto_dao_create.php`

<span class="php"><span class="hljs-meta">&lt;?php</span> 

$novo_produto = [
    <span class="hljs-string">'titulo'</span> =&gt; <span class="hljs-string">'Coleção Livros do Harry Potter'</span>,
    <span class="hljs-string">'descricao'</span> =&gt; <span class="hljs-string">'É uma coleção muito legal'</span>,
    <span class="hljs-string">'preco'</span> =&gt; <span class="hljs-string">'300.00'</span>
    ];

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

create($novo_produto);

$produtos = all();

<span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Lista de produtos no banco de dados:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span> ( $produtos <span class="hljs-keyword">as</span> $produto ) { <span class="hljs-meta">?&gt;</span></span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= implode($produto, <span class="hljs-string">';'</span>)<span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</div></code></pre>
<p>O resultado esperado será a lista de produtos, a qual contém o novo produto adicionado, como segue.</p>
<div style="border: 1px dashed black; padding: 5px;">
<p>Lista de produtos no banco de dados:</p>
<ul>
    <li>1;Kit 4 pares de meias;Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas;20</li>
    <li>2;Camiseta de Algodão;Em tecido de algodão de alta qualidade, a camiseta básica tem ótimo conforto, é indicada para o dia a dia, ou seja, para usar em casa, trabalho ou lazer.;80</li>
    <li>3;Boné;Este boné tem muito estilo.;15</li>
    <li>4;Coleção Livros do Harry Potter;É uma coleção muito legal;300</li>
</ul>
</div>
<p><strong>Desafio 1:</strong> Implemente a função <code>find($id)</code> no arquivo <code>produto_dao.php</code> e crie um arquivo de teste <code>testes_dao/produto_dao_find.php</code> e verifique se está funcionando corretamente para recuperar algum dos produtos na tabela <code>produto</code>.</p>
<p><strong>Desafio 2:</strong> Implemente a função <code>edit($produto)</code> no arquivo <code>produto_dao.php</code> e crie um arquivo de teste <code>testes_dao/produto_dao_edit.php</code> e verifique se está funcionando corretamente. Teste com o seguinte produto:</p>
<pre><code class="language-php"><div>$produto = [
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'4'</span>,
    <span class="hljs-string">'titulo'</span> =&gt; <span class="hljs-string">'Coleção Livros do Harry Potter'</span>,
    <span class="hljs-string">'descricao'</span> =&gt; <span class="hljs-string">'É uma coleção muito legal'</span>,
    <span class="hljs-string">'preco'</span> =&gt; <span class="hljs-string">'500.00'</span>
    ];
</div></code></pre>
<h3 id="função-find">Função find</h3>
<p>A funcionalidade <code>find</code> recebe como parâmetro o id de um produto e tem como objetivo retornar o registro da base de dados referente a esse id. Os dados são retornados no formato de um array associativo, ou seja, no formato $chave =&gt; $valor. Caso ele não encontre nada retorna uma array vazio. No arquivo <code>produto_dao</code> vamos acrescentar a função <code>find</code>, como segue:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>  <span class="hljs-comment">// ... continuando o arquivo produto_dao.php</span>

<span class="hljs-comment">/**
 * A função find($id) recebe id de um produto retorna os 
 * dados do produto se esse id existir, caso contrário, 
 * retorna um array vazio.
 * 
 * <span class="hljs-doctag">@param</span> integer id do produto que quero procurar na tabela.
 * 
 * <span class="hljs-doctag">@return</span> array array no formato chave =&gt; valor com os dados do produto.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">find</span><span class="hljs-params">($id)</span></span>{    
    $conn = get_connection();
    $sql = <span class="hljs-string">'SELECT id, titulo, descricao, preco FROM produto WHERE id = ?'</span>;
    $stmt = $conn-&gt;prepare($sql);
    $stmt-&gt;bind_param(<span class="hljs-string">"i"</span>, $id);    
    $stmt-&gt;execute();
    $instance = [];
    $result = $stmt-&gt;get_result();
    <span class="hljs-keyword">if</span> ($row = $result-&gt;fetch_assoc())
        $instance = $row;    
    $stmt-&gt;close();
    $conn-&gt;close();
    <span class="hljs-keyword">return</span> $instance;
}

<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Após isso, vamos criar um novo programa de teste para testar essa funcionalidade. O arquivo <code>testes_dao/produto_dao_find.php</code> tem o seguinte conteúdo:</p>
<pre><code class="language-html"><div><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo testes_dao/produto_dao_find.php</span>

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

$produto = find(<span class="hljs-string">"4"</span>);

<span class="hljs-keyword">if</span> (!$produto){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Produto não encontrado.'</span>;
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dados do produto:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span>($produto <span class="hljs-keyword">as</span> $key =&gt; $value) { <span class="hljs-meta">?&gt;</span></span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $key<span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>: <span class="php"><span class="hljs-meta">&lt;?</span>= $value <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</div></code></pre>
<p>E o resultado será o seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<p>Dados do produto:</p>
<ul>
    <li><b>id</b>: 4</li>
    <li><b>titulo</b>: Coleção Livros do Harry Potter</li>
    <li><b>descricao</b>: É uma coleção muito legal</li>
    <li><b>preco</b>: 300</li>
</ul>
</div>
<p>Experimente usar outros valores de id, que existam ou não na base de dados, para verificar o resultado.</p>
<h3 id="função-edit">Função edit</h3>
<p>A quarta funcionalidade de DAO é <code>edit</code>. Esta função recebe como parâmetro os dados de um produto, incluíndo o seu id, e tem como objetivo atualizar os dados do produto já existente na base de dados. Assim, no arquivo <code>produto_dao</code> adicionamos mais esta funcionalidade.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// ... continuando o arquivo produto_dao.php</span>

<span class="hljs-comment">/**
 * A função edit($produto) recebe os dados de um 
 * produto e atualiza um registro na tabela `produto`.
 * 
 * <span class="hljs-doctag">@param</span> array um produto na forma de array no formato chave =&gt; valor.
 * 
 * <span class="hljs-doctag">@return</span> boolean retorna true se o registro foi alterado, caso contrário retorna false.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">edit</span><span class="hljs-params">($produto)</span></span>{        
    $conn = get_connection();
    $sql = <span class="hljs-string">'UPDATE produto SET titulo = ?, descricao = ?, preco = ? WHERE id = ?'</span>;    
    $stmt = $conn-&gt;prepare($sql);    
    $stmt-&gt;bind_param(
        <span class="hljs-string">"ssdi"</span>, 
        $produto[<span class="hljs-string">'titulo'</span>], 
        $produto[<span class="hljs-string">'descricao'</span>], 
        $produto[<span class="hljs-string">'preco'</span>],
        $produto[<span class="hljs-string">'id'</span>]);
    $success = $stmt-&gt;execute();    
    $stmt-&gt;close();
    $conn-&gt;close();
    <span class="hljs-keyword">return</span> $success;
}
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Criamos o programa de teste para essa funcionalidade. O arquivo <code>testes_dao/produto_dao_edit.php</code> tem o seguinte conteúdo:</p>
<pre><code class="language-html"><div><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo testes_dao/produto_dao_edit.php</span>

$produto = [
    <span class="hljs-string">'id'</span> =&gt; <span class="hljs-string">'4'</span>,
    <span class="hljs-string">'titulo'</span> =&gt; <span class="hljs-string">'Coleção Livros do Harry Potter'</span>,
    <span class="hljs-string">'descricao'</span> =&gt; <span class="hljs-string">'É uma coleção muito legal'</span>,
    <span class="hljs-string">'preco'</span> =&gt; <span class="hljs-string">'500.00'</span> <span class="hljs-comment">// Valor editado, antes era '300.00'</span>
    ];

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

<span class="hljs-comment">// A função edit retorna falso caso não tenha conseguido editar</span>
<span class="hljs-keyword">if</span> (!edit($produto)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Não ocorreu alteração de dados.'</span>;
    <span class="hljs-keyword">exit</span>;
}

<span class="hljs-comment">// Após alteração procuramos o produto na base de dados</span>
$produto_alterado = find(<span class="hljs-string">'4'</span>);

<span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dados do produto alterado:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span>($produto_alterado <span class="hljs-keyword">as</span> $key =&gt; $value) { <span class="hljs-meta">?&gt;</span></span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $key<span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>: <span class="php"><span class="hljs-meta">&lt;?</span>= $value <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</div></code></pre>
<p>O resultado esperado será o seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<p>Dados do produto:</p>
<ul>
    <li><b>id</b>: 4</li>
    <li><b>titulo</b>: Coleção Livros do Harry Potter</li>
    <li><b>descricao</b>: É uma coleção muito legal</li>
    <li><b>preco</b>: 500</li>
</ul>
</div>
<p>Teste alterar outros valores de id. Você irá verificar que se o id não existe a função retorna falso pois não altera nenhum registro na base de dados. Da mesma forma que se tentar alterar um registro que já existe e você não mudou nada nesse registro, pois também não ocorreu alteração dos dados do mesmo.</p>
<p>Vamos realizar um segundo teste da utilização da funcionalidade <code>edit</code> combinada com a funcionalidade <code>find</code>. Neste teste vamos procurar um registro na base de dados usando <code>find</code>. Após isso, alteramos alguma informação do produto e utilizamos a função <code>edit</code> para enviar essas alterações para a base de dados. O novo arquivo de teste é <code>testes_dao/produto_dao_edit_find.php</code>.</p>
<pre><code class="language-html"><div><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo testes_dao/produto_dao_edit_find.php</span>

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

$produto = find(<span class="hljs-string">'4'</span>);

<span class="hljs-keyword">if</span> (!$produto){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Produto não encontrado.'</span>;
    <span class="hljs-keyword">exit</span>;
}

$produto[<span class="hljs-string">'titulo'</span>] = <span class="hljs-string">'Coleção Livros do Harry Potter Capa Dura'</span>;

<span class="hljs-keyword">if</span> (!edit($produto)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Não ocorreu alteração de dados.'</span>;
    <span class="hljs-keyword">exit</span>;
}

$produto_alterado = find(<span class="hljs-string">'4'</span>)
<span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dados do produto alterado:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span>($produto_alterado <span class="hljs-keyword">as</span> $key =&gt; $value) { <span class="hljs-meta">?&gt;</span></span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $key<span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>: <span class="php"><span class="hljs-meta">&lt;?</span>= $value <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</div></code></pre>
<p>O resultado esperado será o seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<p>Dados do produto:</p>
<ul>
    <li><b>id</b>: 4</li>
    <li><b>titulo</b>: Coleção Livros do Harry Potter Capa Dura</li>
    <li><b>descricao</b>: É uma coleção muito legal</li>
    <li><b>preco</b>: 500</li>
</ul>
</div>
<p>Teste com outros id que existam ou não para verificar que funcionalidade esteja funcionando corretamente.</p>
<h3 id="função-delete">Função delete</h3>
<p>A última funcionalidade básica é o <code>delete</code>. Esta funcionalidade apaga um registro na base de dados utilizando apenas o id do produto, já que esta é a única informação necessária para pagar um registro na base de dados. Como é uma funcionalidade que se comunica com a base de dados também é implementada no arquivo <code>produto_dao.php</code>, da seguinte forma:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// ... continuando o arquivo produto_dao.php</span>

<span class="hljs-comment">/**
 * A função delete($id) recebe o $id de um produto e apaga o registro da base de dados.
 * 
 * <span class="hljs-doctag">@param</span> integer id do produto
 * 
 * <span class="hljs-doctag">@return</span> boolean retorna true se o registro foi apagado, caso contrário retorna false.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delete</span><span class="hljs-params">($id)</span></span>{        
    $conn = get_connection();
    $sql = <span class="hljs-string">'DELETE FROM produto WHERE id = ?'</span>;    
    $stmt = $conn-&gt;prepare($sql);    
    $stmt-&gt;bind_param(<span class="hljs-string">"i"</span>, $id);
    $stmt-&gt;execute();
    $result = $stmt-&gt;affected_rows &gt; <span class="hljs-number">0</span>;
    $stmt-&gt;close();
    $conn-&gt;close();
    <span class="hljs-keyword">return</span> $result;
}
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Criamos o arquivo de teste</p>
<p><code>testes_dao/produto_dao_delete.php</code> tem o seguinte conteúdo:</p>
<pre><code class="language-html"><div><span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo testes_dao/produto_dao_delete.php</span>

<span class="hljs-keyword">include</span>(<span class="hljs-string">'../produto_dao.php'</span>);

<span class="hljs-keyword">if</span> (!delete(<span class="hljs-string">"4"</span>)){
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Não foi possível apagar esse produto.'</span>;
    <span class="hljs-keyword">exit</span>;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Produto apagado com sucesso.'</span>;
    <span class="hljs-keyword">exit</span>;
}

<span class="hljs-meta">?&gt;</span></span>
</div></code></pre>
<p>E o resultado de apagar o produto com id existente na base de dados será o seguinte.</p>
<div style="border: 1px dashed black; padding: 5px;">
Produto apagado com sucesso.
</div>
<p>Caso você tente apagar um produto usando um id que não está na base de dados o resultado será o seguinte. Neste caso também estão arquele produtos que acabamos de apagar da base de dados.</p>
<div style="border: 1px dashed black; padding: 5px;">
Não foi possível apagar esse produto.
</div>
<p><strong>Desafio 1</strong>: crie uma função chamada <code>all_order_by_preco_asc()</code> que retorne os produtos ordenados em ordem crescente de preço.</p>
<p><strong>Desafio 2</strong>: crie uma função chamada <code>all_order_by_preco($order)</code> que recebe a ordem de ordenação ('asc' ou 'desc') e retorna os produtos ordenados por preço de acordo com a escolha.</p>
<p><strong>Desafio 3</strong>: crie uma função chamada <code>all_order_by($column, $order)</code> que recebe a coluna que quer ordenar ('titulo', 'descricao', 'preco') e a ordem de ordenação ('asc' ou 'desc') e retorna os produtos ordenados de acordo com a escolha.</p>
<h2 id="desenvolvendo-as-operações">Desenvolvendo as Operações</h2>
<p>Nesta segunda parte do projeto vamos produzir as páginas com HTML e CSS para interagir com o usuário e relacionar essas páginas às funcionalidades implementadas no DAO.</p>
<p>Essas páginas serão criadas dentro de uma pasta chamada <code>views</code> e consistem nos seguintes arquivos.</p>
<table>
<thead>
<tr>
<th>Arquivo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td>/views/produto_create.php</td>
<td>Exibe o formulário para criar/cadastrar um novo produto</td>
</tr>
<tr>
<td>/views/produto_index.php</td>
<td>Exibe a lista dos produtos presentes na base de dados</td>
</tr>
<tr>
<td>/views/produto_show.php</td>
<td>Exibe as informações de um produto</td>
</tr>
<tr>
<td>/views/produto_edit.php</td>
<td>Exibe o formulário para editar/alterar dados de um produto existente</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="view-create">View create</h3>
<p>Vamos iniciar pela criação da view create. Essa página consiste em um formulário com os dados que devem ser preenchidos para registrar um novo produto na base de dados. A implementação dessa página vai envolver conceitos de HTML, CSS, Bootstrap e PHP.</p>
<pre><code class="language-html"><div><span class="hljs-comment">&lt;!-- arquivo view/produto_create.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Cadastrar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_css.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'header.php'</span> <span class="hljs-meta">?&gt;</span></span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container col-lg-4 col-md-6 col-sm-8 col-10 mt-2"</span>&gt;</span>        
        
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Cadastrar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"produto.php?action=store"</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Título<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"titulo"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"titulo"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Escreva o título ou nome do produto"</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Descrição<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"descricao"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"descricao"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>                
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Preço<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group mb-2"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-prepend input-group-text"</span>&gt;</span>R$<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control col-3"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"preco"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"preco"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">step</span>=<span class="hljs-string">"0.01"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"0,00"</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"bto-cadastrar"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-primary"</span>&gt;</span>Cadastrar<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_js.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Nesse código observamos o <code>include</code> de três arquivos: <code>import_css.php</code>, <code>header.php</code> e <code>import_js.php</code>. O que fizemos foi centralizar a importação de estilos, cabeçalho e a importação de javascripts. Vamos implementar cada um deles para deixar o código funcionando.</p>
<p>Para fazer as páginas de <code>import_css.php</code> e <code>import_js.php</code> vamos acessar o site: <a href="https://getbootstrap.com/">https://getbootstrap.com/</a>. Nesse site observamos um quadro com título <code>Bootstrap CDN</code> e dentro dele temos um subquadro chamado <code>CSS Only</code>. A linha de código  desse subquadro deve ser copiado para o arquivo <code>import_css.php</code> da seguinte forma:</p>
<pre><code class="language-html"><div><span class="hljs-comment">&lt;!-- arquivo views/import_css.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span>
</div></code></pre>
<p>Ainda dentro do quadro <code>Bootstrap CDN</code> temos um subquadro titulado de <code>JS, Popper.js, and jQuery</code>. As linhas de código presentes nesse subquadro vamos copiá-las para o arquivo <code>import_js.php</code> da seguinte forma:</p>
<pre><code class="language-html"><div><span class="hljs-comment">&lt;!-- arquivo views/import_js.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://code.jquery.com/jquery-3.3.1.slim.min.js"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<p>Por fim, vamos criar o nosso arquivo <code>header.php</code> que será o cabeçalho de todas as nossas páginas de interação com o usuário. Ele terá o seguinte conteúdo:</p>
<pre><code class="language-html"><div><span class="hljs-comment">&lt;!-- arquivo views/header.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar navbar-expand navbar-light bg-light"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-brand"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>&gt;</span>DES Loja<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>  
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-nav"</span>&gt;</span>      
      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav-item nav-link"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=index"</span>&gt;</span>Produtos<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> 
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
</div></code></pre>
<p>O reusltado final da implementação dos três arquivos, ao acessarmos o arquivo <code>views/produto_create.php</code>, será o seguinte.</p>
<div style="border: 1px dashed black; padding: 5px;">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<nav class="navbar navbar-expand navbar-light bg-light">
  <a class="navbar-brand" href="#">DES Loja</a>  
  <div class="navbar-nav">      
      <a class="nav-item nav-link" href="produtos.php?action=index"">Produtos</a>      
  </div> 
</nav>
<div class="container col-lg-4 col-md-6 col-sm-8 col-10 mt-2">        
<h2>Cadastrar Produto</h2>
<form method="POST" action="produto.php?action=store">
<div class="form-group">
    <label for="nome">Título</label>
    <input type="text" class="form-control" id="titulo" name="titulo" placeholder="Escreva o título ou nome do produto">
</div>            
<div class="form-group">
    <label for="nome">Descrição</label>
    <textarea class="form-control" id="descricao" name="descricao" rows="4"></textarea>                
</div>            
<div class="form-group">
    <label for="nome">Preço</label>
    <div class="input-group mb-2">
    <div class="input-group-prepend input-group-text">R$</div>
    <input type="number" class="form-control col-3" id="preco" name="preco" min="0" step="0.01" placeholder="0,00">
    </div>
</div>            
<p><button type="submit" id="bto-cadastrar" class="btn btn-primary">Cadastrar</button></p>
</form>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</div>
<p>Como mencionamos no inicio deste projeto para acessar a view que exibe o formulário precisamos consultar a URL <code>/produto.php?action=create</code> via GET e para enviar os dados e armazená-los na base de dados usamos a URL <code>/produto.php?action=store</code> via POST. Abaixo seguem as duas requisições para relembrar:</p>
<table>
<thead>
<tr>
<th>Requisição</th>
<th>URL</th>
<th>Operação</th>
<th>Usa função DAO</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/produto.php?action=create</td>
<td>create</td>
<td>-</td>
<td>Exibe o formulário de criar produto</td>
</tr>
<tr>
<td>POST</td>
<td>/produto.php?action=store</td>
<td>store</td>
<td>create</td>
<td>Recebe os dados do formulário e armazena na base de dados</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Vamos implementar essas duas funcionalidades em um arquivo na pasta raiz do projeto, chamado <code>produto.php</code>. Já vamos deixar o código pronto para implementar as outras funcionalidades também.</p>
<p>Quando a ação solicitada for <code>action=create</code> via GET será executada a inclusão do arquivo <code>views/produto_create.php</code> para mostrar para o usuário o formulário com a página. Quando a ação solicitada for <code>action=store</code> via POST será executado a função <code>create($produto)</code> definida no arquivo <code>produto_dao.php</code>, quem vai de fato cadastrar o produto na base de dados. Após isso, é gerada uma requisição GET para a ação <code>action=index</code>, usando a função <code>header(&quot;Location: produto.php?action=index&quot;)</code>, que vai mostar a lista de produtos (esta funcionalidade não esta implementada ainda, mas será implementada logo a seguir).</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">// arquivo produto.php</span>

<span class="hljs-keyword">include_once</span>(<span class="hljs-string">"produto_dao.php"</span>);

$action = $_GET[<span class="hljs-string">'action'</span>];    

<span class="hljs-keyword">if</span> ( $_SERVER[<span class="hljs-string">'REQUEST_METHOD'</span>] == <span class="hljs-string">'GET'</span>){

    $dados = $_GET;

    <span class="hljs-keyword">switch</span> ($action) {

        <span class="hljs-comment">/**
         * index: Exibe todas os produtos na base de dados
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"index"</span>:
            <span class="hljs-keyword">break</span>;

        <span class="hljs-comment">/**
         * create: Exibe o formulário de criar produto
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"create"</span>:
            <span class="hljs-keyword">include</span>(<span class="hljs-string">"views/produto_create.php"</span>);
            <span class="hljs-keyword">break</span>;

        <span class="hljs-comment">/**
         * show: Procura o produto {id} na base de dados e exibe os dados desse produto
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"show"</span>:        
            <span class="hljs-keyword">break</span>;

        <span class="hljs-comment">/**
         * edit: Procura os dados do produto {id} na base de dados e exibe o 
         *       formulário de editar dados do produto {id}
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"edit"</span>:        
            <span class="hljs-keyword">break</span>;

        <span class="hljs-comment">/**
         * destroy: Exclui um produto
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"destroy"</span>:        
            <span class="hljs-keyword">break</span>;
    }

}

<span class="hljs-keyword">if</span> ( $_SERVER[<span class="hljs-string">'REQUEST_METHOD'</span>] == <span class="hljs-string">'POST'</span>){
    
    $dados = $_POST;
    
    <span class="hljs-keyword">switch</span> ($action) {

        <span class="hljs-comment">/**
         * store: Recebe os dados do formulário e armazena na base de dados
         */</span>        
        <span class="hljs-keyword">case</span> <span class="hljs-string">"store"</span>:            
            create($dados);
            header(<span class="hljs-string">"Location: produto.php?action=index"</span>);
            <span class="hljs-keyword">break</span>;

        <span class="hljs-comment">/**
         * update: Recebe os dados do formulário e salva as alterações no banco
         */</span>                    
        <span class="hljs-keyword">case</span> <span class="hljs-string">"update"</span>:                    
            <span class="hljs-keyword">break</span>;
       
    }

}

<span class="hljs-meta">?&gt;</span>

</div></code></pre>
<p>Desta forma ao acessarmos a URL <code>produto.php?action=create</code> declaramos nossa intenção da criar um novo produto e assim o arquivo <code>produto.php</code> popula a view apropriada. O resultado de acessar essa URL do nosso projeto será justamente a apresentação da view para criar um novo produto.</p>
<h3 id="view-index">View index</h3>
<p>Nesta view o objetivo é mostrar para o usuário uma lista de todos os produtos cadastrados. Para isso vamos criar o arquivo <code>views/produto_index.php</code>. Nesse arquivo vamos aproveitar os arquivos de <code>import_css.php</code>, <code>header.php</code> e <code>import_js.php</code> que criamos para a view <em>create</em>. Vamos assumir também que uma variável <code>$produtos</code> será acessível por meio desta view. Essa variável vai contar uma lista de produtos na forma de um array simples, onde cada elemento do array, um produto, será representado como um array associativo (formato chave =&gt; valor).</p>
<p>O arquivo <code>views/produto_index.php</code> terá o seguinte conteúdo:</p>
<pre><code class="language-html"><div>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lista de Produtos<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_css.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'header.php'</span> <span class="hljs-meta">?&gt;</span></span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container col-md-8 col-12 mt-2"</span>&gt;</span>     
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=create"</span>&gt;</span>Criar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Lista de Produtos<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        
        <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>($produtos) &amp;&amp; $produtos ) { <span class="hljs-meta">?&gt;</span></span> 
        
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span> 
            <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>                    
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"30%"</span>&gt;</span>Título<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"40%"</span>&gt;</span>Conteúdo<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>                    
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"10%"</span>&gt;</span>Preço<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>                    
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>                    
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>             
                <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span> ($produtos <span class="hljs-keyword">as</span> $produto) { <span class="hljs-meta">?&gt;</span></span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>                    
                    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">foreach</span> ($produto <span class="hljs-keyword">as</span> $key =&gt; $value) { <span class="hljs-meta">?&gt;</span></span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $value <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>                        
                    <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-link"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=show&amp;id=&lt;?= $produto['id']?&gt;"</span>&gt;</span>Ver<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-link"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=edit&amp;id=&lt;?= $produto['id']?&gt;"</span>&gt;</span>Edit<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-link"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=destroy&amp;id=&lt;?= $produto['id']?&gt;"</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>                           
                <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
        
        <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-keyword">else</span> { <span class="hljs-meta">?&gt;</span></span> 
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"alert alert-info"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"alert"</span>&gt;</span>
            Nenhum produto cadastrado.
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span> 
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_js.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Para que essa página seja acessível por meio de novo arquivo de operações usando a URL <code>produtos.php?action=index</code> precisamos adicionar o código abaixo à ação &quot;action=index&quot;. Esse código executa a funcionalidade <code>all()</code> implementada em <code>produto_dao.php</code> que retorna todos os produtos na tabela <code>produtos</code> da base de dados, na variável <code>$produto</code>. Uma vez que essa variável contém a lista de produtos populamos a view <code>produto_index.php</code>, quem vai mostrar na tabela os produtos dessa lista.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// ... parte do arquivo produto.php </span>

        <span class="hljs-comment">/**
         * index: Exibe todas os produtos na base de dados
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"index"</span>:
            $produtos = all();  
            <span class="hljs-keyword">include</span>(<span class="hljs-string">"views/produto_index.php"</span>);
            <span class="hljs-keyword">break</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Assim, ao acessarmos a URL <code>produto.php?action=index</code> será apresentado um resultado similar ao seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<nav class="navbar navbar-expand navbar-light bg-light">
  <a class="navbar-brand" href="#">DES Loja</a>  
  <div class="navbar-nav">      
      <a class="nav-item nav-link" href="produtos.php?action=index"">Produtos</a>      
  </div>
</nav>
</header>    
    <div class="container col-md-8 col-12 mt-2">        
<div class="py-2">
<a class="btn btn-success" href="produto.php?action=create">Criar Produto</a>
</div>
<h2>Lista de Produtos</h2>
<table class="table"> 
<thead>
    <tr>                    
        <th>Id</th>
        <th width="30%">Título</th>
        <th width="40%">Conteúdo</th>                    
        <th width="10%">Preço</th>                    
        <th></th>                    
        <th></th>
        <th></th>
    </tr>
</thead>
<tbody>             
    <tr>                    
        <td>3</td>                        
        <td>Kit 4 pares de meias</td>                        
        <td>Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas</td>                        
        <td>20</td>                        
        <td><a class="btn btn-link" href="produto.php?action=show&id=3">Show</a></td>
        <td><a class="btn btn-link" href="produto.php?action=edit&id=3">Edit</a></td>
        <td><a class="btn btn-link" href="produto.php?action=destroy&id=3">Delete</a></td>
    </tr>                           
    <tr>                    
        <td>4</td>                        
        <td>Coleção Livros do Harry Potter</td>                        
        <td>É uma coleção muito legal</td>                        
        <td>500</td>                        ****
        <td><a class="btn btn-link" href="produto.php?action=show&id=4">Show</a></td>****
        <td><a class="btn btn-link" href="produto.php?action=edit&id=4">Edit</a></td>
        <td><a class="btn btn-link" href="produto.php?action=destroy&id=4">Delete</a></td>
    </tr>                           
    <tr>                    
        <td>5</td>                        
        <td>Boné</td>                        
        <td>Este boné tem muito estilo.</td>                        
        <td>15</td>                        
        <td><a class="btn btn-link" href="produto.php?action=show&id=5">Show</a></td>
        <td><a class="btn btn-link" href="produto.php?action=edit&id=5">Edit</a></td>
        <td><a class="btn btn-link" href="produto.php?action=destroy&id=5">Delete</a></td>
    </tr>                           
</tbody>
</table>
</div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</div>
<p>Podemos observar nessa lista de produtos, as funcionalidades de <code>Show</code>, <code>Edit</code> e <code>Delete</code>. Ao passar o mouse por cima dos links e verificar os seus endereços são de operações relacionadas a produtos: <code>action=show</code>, <code>action=edit</code> e <code>action=destroy</code>. Além da informação <code>action</code> enviada via GET, também foi enviada a informação do <code>id</code> do produto que queremos, visualizar, editar ou apagar. Assim a URL <code>produto.php?action=edit&amp;id=3</code> é o endereço que inidica a intenção de alterar os dados do produto de id igual 3. Nas próximas duas seções vamos implementar as views para as operações de <code>Show</code> e <code>Edit</code>.</p>
<p><strong>Desafio 1:</strong> Implementar view <code>views/produto_show.php</code> e relacionar ela com as operações no arquivo <code>produto.php</code>.</p>
<p><strong>Desafio 2:</strong> Implementar view <code>views/produto_edit.php</code> e relacionar ela com as operações no arquivo <code>produto.php</code>.</p>
<h3 id="view-show">View show</h3>
<p>Nesta view o objetivo é mostrar para o usuário as informações de um produto. Para isso primeiro vamos criar um arquivo chamado <code>views/produto_show.php</code> e depois vamos implementar a ação no arquivo <code>produto.php</code> para que seja possível acessar os dados de um produto usando a URL <code>produto.php?action=show&amp;id=1</code> (para exibir o produto id=1).</p>
<p>Para implementar o arquivo <code>views/produto_show.php</code> vamos assumir que uma variável <code>$produto</code> será acessível por meio desta view e que contém os dados do produto na forma de um array associativo (formato chave =&gt; valor).</p>
<pre><code class="language-html"><div><span class="hljs-comment">&lt;!-- arquivo views/produto_show.php --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Mostrar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_css.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'header.php'</span> <span class="hljs-meta">?&gt;</span></span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container col-lg-4 col-md-6 col-sm-8 col-10 mt-2"</span>&gt;</span>    

        <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>($produto) &amp;&amp; $produto ) { <span class="hljs-meta">?&gt;</span></span> 

        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Mostrar dados do Produto<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row my-2"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-4 font-weight-bold"</span>&gt;</span>Título<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-8"</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $produto[<span class="hljs-string">'titulo'</span>] <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>          

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row my-2"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-4 font-weight-bold"</span>&gt;</span>Descricão<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-8"</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $produto[<span class="hljs-string">'descricao'</span>] <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row my-2"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-4 font-weight-bold"</span>&gt;</span>Preco<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-8"</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $produto[<span class="hljs-string">'preco'</span>] <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-group col-12 mt-3"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=edit&amp;id=&lt;?= $produto['id']?&gt;"</span>&gt;</span>Editar Dados<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span>  <span class="hljs-attr">href</span>=<span class="hljs-string">"produto.php?action=destroy&amp;id=&lt;?= $produto['id']?&gt;"</span>&gt;</span>Apagar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-keyword">else</span> { <span class="hljs-meta">?&gt;</span></span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"alert alert-info"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"alert"</span>&gt;</span>
            Nenhum produto para mostrar.
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>        

        <span class="php"><span class="hljs-meta">&lt;?php</span> } <span class="hljs-meta">?&gt;</span></span>       

    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_js.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Para que essa página seja acessada usando a URL <code>produto.php?action=show&amp;id=1</code> precisamos adicionar o código abaixo à ação &quot;action=show&quot;. Esse código utiliza a informação <code>id</code> enviada pela URL na requisição GET e executa a funcionalidade <code>find($id)</code>, implementada em <code>produto_dao.php</code>, que procura na base de dados o referido produto e retorna os dados do produto. Esses dados são armazenados na variável <code>$produto</code>. Uma vez que essa variável contém os dados do produto que queremos mostrar populamos a view <code>produto_show.php</code>.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// ... parte do arquivo produto.php </span>

        <span class="hljs-comment">/**
         * index: Exibe todas os produtos na base de dados
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"show"</span>:
            $produto = find($dados[<span class="hljs-string">'id'</span>]);
            <span class="hljs-keyword">include</span>(<span class="hljs-string">"views/produto_show.php"</span>);
            <span class="hljs-keyword">break</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Assim, ao acessarmos a URL <code>produto.php?action=show&amp;id=1</code>, para um <code>id=1</code> existente na base de dados será apresentado um resultado similar ao seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<body>
<header>
<nav class="navbar navbar-expand navbar-light bg-light">
  <a class="navbar-brand" href="#">DES Loja</a>  
  <div class="navbar-nav">      
      <a class="nav-item nav-link" href="produto.php?action=index"">Produtos</a>  
  </div>
</nav>
</header>
<div class="container col-lg-4 col-md-6 col-sm-8 col-10 mt-2">    
<h2>Mostrar dados do Produto</h2>
<div class="row my-2">
    <div class="col-4 font-weight-bold">Título</div>
    <div class="col-8">Kit 4 pares de meias</div>            
</div>          
<div class="row my-2">
    <div class="col-4 font-weight-bold">Descricão</div>
    <div class="col-8">Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas</div>            
</div>            
<div class="row my-2">
    <div class="col-4 font-weight-bold">Preco</div>
    <div class="col-8">20</div>            
</div>            
<div class="btn-group col-12 mt-3">
    <a class="btn btn-success" href="produto.php?action=edit">Editar Dados</a>
    <a class="btn btn-danger"  href="produto.php?action=destroy">Apagar Produto</a>
</div>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</div>
<h3 id="view-edit">View edit</h3>
<p>Nesta view o objetivo é mostrar para o usuário as informações de um produto em um formulário para que o mesmo possa alterar os dados do produto. Esse formulário certamente será parecido com o formulário construído para a view create.</p>
<p>Primeiramente vamos criar um arquivo chamado <code>views/produto_edit.php</code> e depois vamos implementar a ação no arquivo <code>produto.php</code> para que seja possível mostrar o formulário de edição usando a URL <code>produto.php?action=edit&amp;id=1</code> (para editar o produto id=1).</p>
<p>Para implementar o arquivo <code>views/produto_edit.php</code> também vamos assumir que uma variável <code>$produto</code> será acessível por meio desta view e que contém os dados do produto na forma de um array associativo (formato chave =&gt; valor).</p>
<pre><code class="language-html"><div><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Editar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_css.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

    <span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'header.php'</span> <span class="hljs-meta">?&gt;</span></span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container col-lg-4 col-md-6 col-sm-8 col-10 mt-2"</span>&gt;</span>        
        
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Editar Produto<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"produto.php?action=update"</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"&lt;?= $produto['id'] ?&gt;"</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Título<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"titulo"</span> 
                <span class="hljs-attr">name</span>=<span class="hljs-string">"titulo"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Escreva o título ou nome do produto"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">"&lt;?= $produto['titulo'] ?&gt;"</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Descrição<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"descricao"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"descricao"</span> 
                <span class="hljs-attr">rows</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="php"><span class="hljs-meta">&lt;?</span>= $produto[<span class="hljs-string">'descricao'</span>] <span class="hljs-meta">?&gt;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>                
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"nome"</span>&gt;</span>Preço<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group mb-2"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-prepend input-group-text"</span>&gt;</span>R$<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control col-3"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"preco"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"preco"</span> 
                <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">step</span>=<span class="hljs-string">"0.01"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"0,00"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"&lt;?= $produto['preco'] ?&gt;"</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            

            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"bto-cadastrar"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-primary"</span>&gt;</span>Confirmar<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">include</span> <span class="hljs-string">'import_js.php'</span> <span class="hljs-meta">?&gt;</span></span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Para que essa página seja acessada usando a URL <code>produto.php?action=edit&amp;id=1</code> precisamos adicionar o código abaixo à ação &quot;action=edit&quot;. Este código também utiliza a informação <code>id</code> enviada pela URL na requisição GET e executa a funcionalidade <code>find($id)</code>, que procura na base de dados o referido produto e retorna os dados do produto. Esses dados são armazenados na variável <code>$produto</code> e utilizados para popular a view <code>produto_edit.php</code>.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// ... parte do arquivo produto.php </span>

        <span class="hljs-comment">/**
         * index: Exibe todas os produtos na base de dados
         */</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">"edit"</span>:
            $produto = find($dados[<span class="hljs-string">'id'</span>]);
            <span class="hljs-keyword">include</span>(<span class="hljs-string">"views/produto_edit.php"</span>);
            <span class="hljs-keyword">break</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Assim, ao acessarmos a URL <code>produto.php?action=edit&amp;id=1</code>, para um <code>id=1</code> existente na base de dados será apresentado um resultado similar ao seguinte:</p>
<div style="border: 1px dashed black; padding: 5px;">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<body>
<header>
<nav class="navbar navbar-expand navbar-light bg-light">
  <a class="navbar-brand" href="#">DES Loja</a>  
  <div class="navbar-nav">      
      <a class="nav-item nav-link" href="produto.php?action=index"">Produtos</a>      
  </div>
</nav>
</header>
    <div class="container col-lg-4 col-md-6 col-sm-8 col-10 mt-2">        
<h2>Editar Produto</h2>
<form method="POST" action="produto.php?action=store">
<input type="hidden" name="id" value="3">
<div class="form-group">
    <label for="nome">Título</label>
    <input type="text" class="form-control" id="titulo" 
    name="titulo" placeholder="Escreva o título ou nome do produto"
    value="Kit 4 pares de meias">
</div>            
<div class="form-group">
    <label for="nome">Descrição</label>
    <textarea class="form-control" id="descricao" name="descricao" 
    rows="4">Essas meias proporcionam conforto e proteção para os pés no dia a dia e durante suas atividades físicas</textarea>                
</div>            
<div class="form-group">
    <label for="nome">Preço</label>
    <div class="input-group mb-2">
    <div class="input-group-prepend input-group-text">R$</div>
    <input type="number" class="form-control col-3" id="preco" name="preco" 
    min="0" step="0.01" placeholder="0,00" value="20">
    </div>
</div>            
<p><button type="submit" id="bto-cadastrar" class="btn btn-primary">Salvar</button></p>
</form>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</div>
<p>O botão <code>Salvar</code> deve executar a operação de atualizar os dados. Para isso ao clicar no botão será gerada uma requisição via POST para a URL <code>produto.php?action=update</code>. Portanto, devemos implementar essa ação no arquivo <code>produto.php</code>. Essa ação vai executar a operação de <code>edit($produto)</code> implementada no arquivo <code>produto_dao.php</code> e após alterar as informações vai redirecionar o usuário para a lista de produtos.</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// ... parte do arquivo produto.php </span>

        <span class="hljs-comment">/**
         * update: Recebe os dados do formulário e salva as alterações no banco
         */</span>                    
        <span class="hljs-keyword">case</span> <span class="hljs-string">"update"</span>:                    
            edit($dados);
            header(<span class="hljs-string">"Location: produto.php?action=index"</span>);
            <span class="hljs-keyword">break</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Para finalizar as operações de CRUD precisamos implementar a funcionalidade de apagar um registro na base de dados. A <code>action=destroy</code> é uma ação realizada via GET com a seguinte URL <code>produto.php?action=destroy&amp;id=1</code> (para apagar o produto de id=1). A implementação dessa funcionalidade no arquivo <code>produto.php</code> é realizada a seguir:</p>
<pre><code class="language-php"><div><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">// ... parte do arquivo produto.php </span>

        <span class="hljs-comment">/**
         * destroy: Recebe o {id} do produto e apaga o produto do banco
         */</span>                    
        <span class="hljs-keyword">case</span> <span class="hljs-string">"destroy"</span>:                    
            delete($dados[<span class="hljs-string">'id'</span>]);
            header(<span class="hljs-string">"Location: produto.php?action=index"</span>);
            <span class="hljs-keyword">break</span>;
<span class="hljs-comment">// ...</span>
<span class="hljs-meta">?&gt;</span>
</div></code></pre>
<p>Com essa funcionalidade concluímos o nosso CRUD de Produtos. Certamente existem melhorias a serem realizadas. Uma dessas melhorias é maior interação com o usuário pedindo confirmações para editar ou apagar produtos. Isso pode ser feito utilizando Javascript.</p>
<p><strong>Desafio 1:</strong> Implemente a mensagem de confirmação em Javascript (JQuery se preferir) para quando o usuário tiver a inteção de apagar um produto.</p>
<p><strong>Desafio 2:</strong> Implemente as mensagem de confirmação em Javascript para quando o usuário estiver confirmando a edição de dados de um produto.</p>

    </body>
    </html>